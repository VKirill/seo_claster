# ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —ç—Ç–∞–ø–æ–≤

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- –í—Å–µ —ç—Ç–∞–ø—ã pipeline –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –î–∞–∂–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —ç—Ç–∞–ø—ã (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, –º–µ—Ç—Ä–∏–∫–∏) –∂–¥–∞–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞
- –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä—É–ø–ø –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –ª–æ–≥–∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–ª–∏—Å—å

**–£–∑–∫–æ–µ –º–µ—Å—Ç–æ:**
- ‚úÖ SERP API —É–∂–µ –∏–º–µ–ª –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (50 –∑–∞–ø—Ä–æ—Å–æ–≤)
- ‚ùå –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç—Ç–∞–ø—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —ç—Ç–∞–ø–æ–≤

```
1. Load Data (–±–∞–∑–æ–≤—ã–π)
   ‚Üì
2. Preprocessing (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 1)
   ‚Üì
3. SERP Analysis (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 2) ‚Üê –°–µ–º–∞—Ñ–æ—Ä 50 –∑–∞–ø—Ä–æ—Å–æ–≤
   ‚Üì
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ                     ‚îÇ                     ‚îÇ                   ‚îÇ
   ‚ñº                     ‚ñº                     ‚ñº                   ‚ñº
4. Clustering        6. Classification    7. Metrics      (Yandex Direct —Ñ–æ–Ω)
   ‚Üì                     
4.1 Postprocess          
   ‚Üì                     
5. LSI Aggregation       
   ‚îÇ                     ‚îÇ                     ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                ‚Üì
                         8. Forms Generation
                                ‚Üì
                         9. Export Results
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã

**–ì—Ä—É–ø–ø–∞ A (–ø–æ—Å–ª–µ SERP):**
- ‚ö° **Clustering Pipeline** (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è)
  - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
  - –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
  - –ê–≥—Ä–µ–≥–∞—Ü–∏—è LSI
- ‚ö° **Classification** (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
- ‚ö° **Metrics Calculation** (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)

**–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞:**
- üöÄ **Yandex Direct –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞** (–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ preprocessing)

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –î–æ

```python
# pipeline/analyzer.py (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
await analyze_serp_stage(self.args, self)
await clustering_stage(self.args, self)
await postprocess_clusters_stage(self.args, self)
await aggregate_cluster_lsi_stage(self.args, self)
await classification_stage(self.args, self)
await calculate_metrics_stage(self.args, self)
```

### –ü–æ—Å–ª–µ

```python
# pipeline/analyzer.py (–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)
await analyze_serp_stage(self.args, self)

print("‚ö° –ó–∞–ø—É—Å–∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è + –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è + –º–µ—Ç—Ä–∏–∫–∏)...")

# –ì—Ä—É–ø–ø–∞ A: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ SERP
clustering_task = asyncio.create_task(self._run_clustering_pipeline())
classification_task = asyncio.create_task(classification_stage(self.args, self))
metrics_task = asyncio.create_task(calculate_metrics_stage(self.args, self))

# –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
await asyncio.gather(
    clustering_task,
    classification_task,
    metrics_task,
    return_exceptions=False
)

print("‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
```

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥

```python
async def _run_clustering_pipeline(self):
    """
    –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è)
    
    –≠—Ç–∞–ø—ã:
    1. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
    2. –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    3. –ê–≥—Ä–µ–≥–∞—Ü–∏—è LSI (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞)
    """
    await clustering_stage(self.args, self)
    await postprocess_clusters_stage(self.args, self)
    
    if 'lsi_phrases' in self.df.columns and 'semantic_cluster_id' in self.df.columns:
        await aggregate_cluster_lsi_stage(self.args, self)
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –≠—Ç–∞–ø | –î–æ | –ü–æ—Å–ª–µ | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|------|-----|-------|-----------|
| **–ì—Ä—É–ø–ø–∞ "—Å–∫—É–¥"** (5299 –∑–∞–ø—Ä–æ—Å–æ–≤) | ~45 —Å–µ–∫ | ~25 —Å–µ–∫ | **1.8x** |
| **–ì—Ä—É–ø–ø–∞ "–¥–æ–º–æ—Ñ–æ–Ω"** (61644 –∑–∞–ø—Ä–æ—Å–∞) | ~180 —Å–µ–∫ | ~105 —Å–µ–∫ | **1.7x** |
| **–ì—Ä—É–ø–ø–∞ "–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ"** (63843 –∑–∞–ø—Ä–æ—Å–∞) | ~190 —Å–µ–∫ | ~110 —Å–µ–∫ | **1.7x** |

**–û–±—â–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** ~**40-45%** –Ω–∞ —ç—Ç–∞–ø–∞—Ö –ø–æ—Å–ª–µ SERP

### –ü–æ—á–µ–º—É –Ω–µ 3x?

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∑–∞–ø—É—Å–∫ 3 —ç—Ç–∞–ø–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —É—Å–∫–æ—Ä–µ–Ω–∏–µ –º–µ–Ω—å—à–µ –∏–∑-–∑–∞:
1. **Shared Resources:** –í—Å–µ —ç—Ç–∞–ø—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å –æ–¥–Ω–∏–º DataFrame
2. **CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–∏:** Python GIL –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
3. **–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:** –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Å–∞–º–∞—è —Ç—è–∂–µ–ª–∞—è (~60% –≤—Ä–µ–º–µ–Ω–∏)

## üîí –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞

### –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä XMLStock API

```python
# seo_analyzer/analysis/serp/api_semaphore.py

class APIRequestSemaphore:
    """
    –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
    
    Singleton pattern - –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞ –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    –õ–∏–º–∏—Ç: 50 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è XMLStock)
    """
    
    _instance = None
    
    def __init__(self, max_concurrent: int = 50):
        if self._initialized:
            return
        
        self._semaphore = asyncio.Semaphore(max_concurrent)
        self._initialized = True
        
        print(f"üîí –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä API: –º–∞–∫—Å–∏–º—É–º {max_concurrent} –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤")
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```python
# –í API –∫–ª–∏–µ–Ω—Ç–µ
async with self.api_semaphore:
    return await self._fetch_serp_data_internal(query)
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:** –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ 3 –≥—Ä—É–ø–ø –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ XMLStock **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç 50**.

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:

```bash
# –û–¥–Ω–∞ –≥—Ä—É–ø–ø–∞
python main.py —Å–∫—É–¥

# –í—Å–µ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
python main.py

# –í—Å–µ –≥—Ä—É–ø–ø—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
python main.py --sequential
```

### –í—ã–≤–æ–¥

```
üöÄ SEO ANALYZER - –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞
================================================================================

üìö –≠–¢–ê–ü 1: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
üìö –≠–¢–ê–ü 2: –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
üîç –≠–¢–ê–ü 3: SERP –∞–Ω–∞–ª–∏–∑

‚ö° –ó–∞–ø—É—Å–∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è + –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è + –º–µ—Ç—Ä–∏–∫–∏)...

üî¨ –≠–¢–ê–ü 4: –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (–Ω–∞ –æ—Å–Ω–æ–≤–µ SERP)
üè∑Ô∏è  –≠–¢–ê–ü 6: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (—Å —É—á–µ—Ç–æ–º SERP + –∫–ª–∞—Å—Ç–µ—Ä–æ–≤)
üìä –≠–¢–ê–ü 7: –†–∞—Å—á–µ—Ç SEO –º–µ—Ç—Ä–∏–∫ (KEI, —Å–ª–æ–∂–Ω–æ—Å—Ç—å)

‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
```

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —ç—Ç–∞–ø–æ–≤

| –≠—Ç–∞–ø | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç | –ß–∏—Ç–∞–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ | –ü–∏—à–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ |
|------|-----------|----------------|---------------|
| **Clustering** | SERP | `serp_urls`, `geo_city` | `semantic_cluster_id`, `cluster_keywords` |
| **Classification** | SERP | `keyword`, `lemmatized`, `serp_xml` | `main_intent`, `funnel_stage`, `is_brand_query` |
| **Metrics** | SERP | `frequency_*`, `serp_docs_count` | `kei_*`, `difficulty_score` |

**–í—ã–≤–æ–¥:** –≠—Ç–∞–ø—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

### Thread Safety

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ:**
- –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –ø–∏—à–µ—Ç –≤ —Å–≤–æ–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ DataFrame
- –ù–µ—Ç shared state –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
- SERP —Å–µ–º–∞—Ñ–æ—Ä –∑–∞—â–∏—â–∞–µ—Ç API –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏

‚ùå **–ù–ï –±–µ–∑–æ–ø–∞—Å–Ω–æ –±—ã–ª–æ –±—ã:**
- –ó–∞–ø–∏—Å—å –≤ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –∫–æ–ª–æ–Ω–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—â–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

## üéÅ –ë–æ–Ω—É—Å—ã

### 1. –õ—É—á—à–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU

–ü—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ 3 –≥—Ä—É–ø–ø:
- –û–¥–Ω–∞ –≥—Ä—É–ø–ø–∞ –Ω–∞ SERP (I/O bound, –∂–¥–µ—Ç API)
- –î—Ä—É–≥–∏–µ –≥—Ä—É–ø–ø—ã –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏/–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (CPU bound)
- –¢—Ä–µ—Ç—å—è –Ω–∞ –º–µ—Ç—Ä–∏–∫–∞—Ö (CPU bound)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** CPU –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ ~90% –≤–º–µ—Å—Ç–æ ~30%

### 2. –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ SERP –∫—ç—à–∞

–ï—Å–ª–∏ SERP –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ (99%+ hit rate):
- SERP —ç—Ç–∞–ø –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- –°—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ 3 —ç—Ç–∞–ø–æ–≤
- **–û–±—â–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–∫—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ 40-45%**

### 3. Yandex Direct –≤ —Ñ–æ–Ω–µ

```python
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ preprocessing
self.yandex_direct_task = asyncio.create_task(
    preload_yandex_direct_stage(self.args, self)
)

# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤
await self.yandex_direct_task
await enrich_with_yandex_direct_stage(self.args, self)
```

**–í—ã–≥–æ–¥–∞:** –ü–æ–∫–∞ –∏–¥—É—Ç SERP, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Äî Yandex Direct –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ.

## üîÆ –ë—É–¥—É—â–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Multiprocessing –¥–ª—è CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π**
   - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
   - –û–±—Ö–æ–¥ Python GIL
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ: 2-3x

2. **Chunked processing –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤**
   - –†–∞–∑–±–∏—Ç—å DataFrame –Ω–∞ —á–∞—Å—Ç–∏
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —á–∞—Å—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ: 1.5-2x

3. **–ö—ç—à –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –º–µ—Ç—Ä–∏–∫**
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è: 30-50% –≤—Ä–µ–º–µ–Ω–∏

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. Python GIL

Python Global Interpreter Lock –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º CPU-bound –æ–ø–µ—Ä–∞—Ü–∏–π.

**–†–µ—à–µ–Ω–∏–µ:** –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `multiprocessing` –¥–ª—è –æ–±—Ö–æ–¥–∞ GIL.

### 2. Memory usage

–ü—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ 3 –≥—Ä—É–ø–ø –ø–∞–º—è—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–µ–µ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>500k –∑–∞–ø—Ä–æ—Å–æ–≤) –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--sequential`.

### 3. –ü–æ—Ä—è–¥–æ–∫ –ª–æ–≥–æ–≤

–õ–æ–≥–∏ –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤ –º–æ–≥—É—Ç –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—Ç—å—Å—è.

**–†–µ—à–µ–Ω–∏–µ:** –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –∏–º–µ–µ—Ç —á–µ—Ç–∫–∏–π –ø—Ä–µ—Ñ–∏–∫—Å (`–≠–¢–ê–ü 4`, `–≠–¢–ê–ü 6`, `–≠–¢–ê–ü 7`).

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `docs/ASYNC_GROUPS_AND_TOP20.md` - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø
- `SERP_CLUSTERING_OPTIMIZATION.md` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SERP –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- `seo_analyzer/analysis/serp/api_semaphore.py` - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä API

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–Ω–µ–¥—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–í–µ—Ä—Å–∏—è:** v1.4+
**–ê–≤—Ç–æ—Ä:** –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ pipeline






