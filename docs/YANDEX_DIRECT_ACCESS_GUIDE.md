# üö´ Yandex Direct API: "No Access" (Error 58)

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ Yandex Direct API –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É:

```
error_code: 58
error_str: "No access"
error_detail: "You need to fill out an app access request in the Direct interface and wait for confirmation"
```

## –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç?

–í–∞—à–µ OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Direct API**. –Ø–Ω–¥–µ–∫—Å —Ç—Ä–µ–±—É–µ—Ç —è–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ–¥–æ–±—Ä–µ–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ API

### –®–∞–≥ 1: –ó–∞–π–¥–∏—Ç–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://direct.yandex.ru/
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç

### –®–∞–≥ 2: –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª API

- –û–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤: **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí API**
- –ò–ª–∏: **–ü—Ä–æ—Ñ–∏–ª—å ‚Üí –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ ‚Üí API Direct**

### –®–∞–≥ 3: –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –¥–æ—Å—Ç—É–ø

–í–∞–º –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å:
- **–¶–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: "–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ SEO"
- **–û–ø–∏—Å–∞–Ω–∏–µ**: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π"
- **–û–±—ä–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤**: "–î–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å"

### –®–∞–≥ 4: –î–æ–∂–¥–∏—Ç–µ—Å—å –æ–¥–æ–±—Ä–µ–Ω–∏—è

- –Ø–Ω–¥–µ–∫—Å —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –∑–∞—è–≤–∫–∏ –æ–±—ã—á–Ω–æ 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è
- –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ email

---

## üß™ –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Sandbox

–ü–æ–∫–∞ –∂–¥–µ—Ç–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è, –º–æ–∂–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å **Sandbox API** (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º):

### –í `config_local.py`:

```python
# –í—Ä–µ–º–µ–Ω–Ω–æ –≤–∫–ª—é—á–∞–µ–º Sandbox —Ä–µ–∂–∏–º
YANDEX_DIRECT_USE_SANDBOX = True
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: Sandbox API:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –¢–∞ –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
- ‚ùå –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ (–Ω–µ —Ä–µ–∞–ª—å–Ω—ã–µ) –¥–∞–Ω–Ω—ã–µ
- ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

---

## üîß –ß—Ç–æ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ

–í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ—Ç–ª–∞–¥–∫–∏ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:

1. **‚úÖ Production URL**: –ò–∑–º–µ–Ω–µ–Ω —Å `/json/v5/` –Ω–∞ `/live/v4/json/`
2. **‚úÖ UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–∞**: –ó–∞–ø—Ä–æ—Å—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π
3. **‚úÖ Debug —Ä–µ–∂–∏–º**: –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

---

## üöÄ –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞

–ö–æ–≥–¥–∞ –Ø–Ω–¥–µ–∫—Å –æ–¥–æ–±—Ä–∏—Ç –¥–æ—Å—Ç—É–ø:

1. –ò–∑–º–µ–Ω–∏—Ç–µ –≤ `config_local.py`:
```python
YANDEX_DIRECT_USE_SANDBOX = False  # ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ Production
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:
```bash
python test_yandex_direct_debug.py
```

3. –ï—Å–ª–∏ –≤—Å—ë –û–ö - –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∞–Ω–∞–ª–∏–∑:
```bash
python main.py
```

---

## üìû –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ https://oauth.yandex.ru/ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø `direct:api`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω (–Ω–µ –∏—Å—Ç–µ–∫)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∑–∞—è–≤–∫–∞ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ API –±—ã–ª–∞ –æ–¥–æ–±—Ä–µ–Ω–∞

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://yandex.ru/dev/direct/doc/dg/concepts/about.html
- OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: https://oauth.yandex.ru/
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞: `python get_yandex_direct_token.py`

---

**üéØ –ò—Ç–æ–≥**: –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ API. –ù—É–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –µ–≥–æ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç –∏ –¥–æ–∂–¥–∞—Ç—å—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏—è.

