# Master Query Database - –ï–¥–∏–Ω–∞—è –ë–î üöÄ

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ? üí°

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (`min_common_urls` 7‚Üí8) –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å 9+ –º–∏–Ω—É—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–Ω—Ç–µ–Ω—Ç–∞ –∑–∞–Ω–æ–≤–æ!

**–†–µ—à–µ–Ω–∏–µ:** –ï–¥–∏–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `master_queries` —Å–æ –í–°–ï–ú–ò –¥–∞–Ω–Ω—ã–º–∏:
- Intent, SERP, –º–µ—Ç—Ä–∏–∫–∏, –±—Ä–µ–Ω–¥—ã ‚Üí **–∫—ç—à–∏—Ä—É—é—Ç—Å—è**
- –ö–ª–∞—Å—Ç–µ—Ä—ã ‚Üí **—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞ 30 —Å–µ–∫**

## –ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è ‚úÖ

```sql
master_queries (
    -- –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞: normalized, lemmatized, NER
    -- Intent: main_intent, commercial_score, —Ñ–ª–∞–≥–∏
    -- SERP: found_docs, offer_ratio, top_urls (JSON), LSI
    -- Direct: shows, CTR, CPC, competition
    -- –ú–µ—Ç—Ä–∏–∫–∏: KEI, difficulty, traffic
    -- –ë—Ä–µ–Ω–¥—ã: detected_brand, funnel_stage
)
```

## –ß—Ç–æ –ù–ï —Ö—Ä–∞–Ω–∏—Ç—Å—è ‚ùå

–ö–ª–∞—Å—Ç–µ—Ä—ã! –û–Ω–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
- `semantic_cluster_id`, `cluster_name`
- `hierarchical_level1/2/3`
- `topic_id` (LDA)

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚ö°

### –ë–µ–∑ Master DB
```
–ó–∞–ø—É—Å–∫ 1: 16 –º–∏–Ω—É—Ç
–ó–∞–ø—É—Å–∫ 2 (–º–∏–Ω_—É—Ä–ª 8): 13 –º–∏–Ω—É—Ç (–∏–Ω—Ç–µ–Ω—Ç –∑–∞–Ω–æ–≤–æ!)
–ó–∞–ø—É—Å–∫ 3 (–º–∏–Ω_—É—Ä–ª 10): 11 –º–∏–Ω—É—Ç
```

### –° Master DB
```
–ó–∞–ø—É—Å–∫ 1: 16 –º–∏–Ω—É—Ç + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
–ó–∞–ø—É—Å–∫ 2: 33 —Å–µ–∫—É–Ω–¥—ã! üöÄ
–ó–∞–ø—É—Å–∫ 3: 33 —Å–µ–∫—É–Ω–¥—ã! üöÄ
```

**–£—Å–∫–æ—Ä–µ–Ω–∏–µ: 20x!**

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
master_db = MasterQueryDatabase()
master_db.save_queries("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", analyzer.df)

# –ó–∞–≥—Ä—É–∑–∫–∞ + –Ω–æ–≤–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
df = master_db.load_queries("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ")
clusters = SERPAdvancedClusterer(min_common_urls=8).cluster(df)
```

## –ö–ª—é—á–µ–≤–∞—è —Ñ–∏—á–∞: serp_top_urls

```python
# JSON –º–∞—Å—Å–∏–≤ TOP-20 URL –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
[
    {"url": "https://...", "domain": "...", "position": 1},
    ...
]
```

**–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ë–ï–ó –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ serp_data.db!**

## –°–º. —Ç–∞–∫–∂–µ

- `seo_analyzer/core/cache/master_query_db.py`
- `seo_analyzer/core/cache/master_query_schema.py`

