# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ XMLStock API

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ XMLStock

–°–æ–≥–ª–∞—Å–Ω–æ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ XMLStock](https://xmlstock.com):

> **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞:**
> 
> –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –∏–∑–ª–∏—à–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ —Å–µ—Ä–≤–∏—Å –Ø–Ω–¥–µ–∫—Å XML, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Å–æ–±–∏—Ä–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ –±–æ–ª–µ–µ —á–µ–º –≤ **50 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤** –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π.

> **–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º** —Å–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –±–æ–ª—å—à–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏, –≤—ã–¥–µ—Ä–∂–∏–≤–∞—è –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏. –ù–∞–ø—Ä–∏–º–µ—Ä –æ–¥–Ω–æ–º–æ–º–µ–Ω—Ç–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞–∫–µ—Ç –∏–∑ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤. –ß–∞—Å—Ç—å –∏–∑ —ç—Ç–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞—é—Ç—Å—è, —á–∞—Å—Ç—å –≤—Å—Ç–∞–Ω–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—Å–µ–∫—É—Ç—Å—è.

## ‚úÖ –ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä (Singleton)

–ú—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ **–≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä** –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```python
# seo_analyzer/analysis/serp/api_semaphore.py

class APIRequestSemaphore:
    """
    –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
    
    - Singleton pattern: –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞ –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    - –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –í–°–ï–• –≥—Ä—É–ø–ø
    - –ú–∞–∫—Å–∏–º—É–º 50 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    """
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

#### 1. **–û–¥–∏–Ω —Å–µ–º–∞—Ñ–æ—Ä –¥–ª—è –≤—Å–µ—Ö**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          –ì–õ–û–ë–ê–õ–¨–ù–´–ô –°–ï–ú–ê–§–û–† (max=50)                ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ –ì—Ä—É–ø–ø–∞ 1 ‚îÇ  ‚îÇ –ì—Ä—É–ø–ø–∞ 2 ‚îÇ  ‚îÇ –ì—Ä—É–ø–ø–∞ 3 ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ 15 –∑–∞–¥–∞—á ‚îÇ  ‚îÇ 20 –∑–∞–¥–∞—á ‚îÇ  ‚îÇ 15 –∑–∞–¥–∞—á ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  –í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: 50 (–Ω–µ –±–æ–ª—å—à–µ!)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**

```python
# –í API –∫–ª–∏–µ–Ω—Ç–µ
async def fetch_serp_data(self, query: str):
    # –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Å–ª–æ—Ç –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —Å–µ–º–∞—Ñ–æ—Ä–µ
    async with self.api_semaphore.semaphore:
        # –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å
        return await self._fetch_serp_data_internal(query)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ì—Ä—É–ø–ø–∞ 1 –∑–∞–ø—É—Å–∫–∞–µ—Ç 1000 –∑–∞–¥–∞—á ‚Üí –≤—Å–µ –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏
2. –ì—Ä—É–ø–ø–∞ 2 –∑–∞–ø—É—Å–∫–∞–µ—Ç 800 –∑–∞–¥–∞—á ‚Üí –≤—Å–µ –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏  
3. –ì—Ä—É–ø–ø–∞ 3 –∑–∞–ø—É—Å–∫–∞–µ—Ç 500 –∑–∞–¥–∞—á ‚Üí –≤—Å–µ –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏
4. **–ù–æ –∫ API –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ 50 –∑–∞–ø—Ä–æ—Å–æ–≤**
5. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è ‚Üí —Å–ª–µ–¥—É—é—â–∏–π –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è
6. **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è**

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º XMLStock**
- –ú–∞–∫—Å–∏–º—É–º 50 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- –°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏ multi-group –æ–±—Ä–∞–±–æ—Ç–∫–µ**
- 4 –≥—Ä—É–ø–ø—ã –ø–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ = 4000 –∑–∞–¥–∞—á
- –ù–æ –∫ API –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ 50 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ù–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞

‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å**
- –ù–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –ù–µ—Ç –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å –ø—Ä–æ—Å—Ç–æ—è–º–∏
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤

‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞**
- –ì—Ä—É–ø–ø—ã —Å –∫—ç—à–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–±–µ–∑ API)
- –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã —Å—Ä–∞–∑—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ –≥—Ä—É–ø–ø–∞–º–∏

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏

–í `config_local.py`:

```python
SERP_CONFIG_OVERRIDES = {
    "api": {
        "max_concurrent": 50,  # –ò–∑–º–µ–Ω–∏—Ç–µ –µ—Å–ª–∏ XMLStock —Ä–∞–∑—Ä–µ—à–∏–ª –±–æ–ª—å—à–µ
    }
}
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –±–µ–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Å XMLStock!

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from seo_analyzer.analysis.serp import get_api_semaphore

semaphore = get_api_semaphore()
stats = semaphore.get_stats()

print(f"–ú–∞–∫—Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö: {stats['max_concurrent']}")
print(f"–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: {stats['active_requests']}")
print(f"–í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: {stats['total_requests']}")
print(f"–°–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤: {stats['available_slots']}")
```

## üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–º–µ—Ä 1: –û–¥–Ω–∞ –≥—Ä—É–ø–ø–∞ (1000 –∑–∞–ø—Ä–æ—Å–æ–≤)

```
üìä –ì—Ä—É–ø–ø–∞: —Å–∫—É–¥ (1000 –∑–∞–ø—Ä–æ—Å–æ–≤)
‚úì –í –∫—ç—à–µ: 0
‚ö° –ù—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å: 1000

–ü—Ä–æ—Ü–µ—Å—Å:
- –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤—Å–µ 1000 –∑–∞–¥–∞—á
- –ù–æ –∫ API –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ 50
- –ü–æ –º–µ—Ä–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, —Å–ª–µ–¥—É—é—â–∏–µ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è
- –í—Ä–µ–º—è: ~20 –º–∏–Ω—É—Ç (–ø—Ä–∏ 10 —Å–µ–∫ –Ω–∞ –∑–∞–ø—Ä–æ—Å)
```

### –ü—Ä–∏–º–µ—Ä 2: –ß–µ—Ç—ã—Ä–µ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

```
üìä –ì—Ä—É–ø–ø–∞ 1: —Å–∫—É–¥ (1000 –∑–∞–ø—Ä–æ—Å–æ–≤, 0 –≤ –∫—ç—à–µ)
üìä –ì—Ä—É–ø–ø–∞ 2: –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ (5000 –∑–∞–ø—Ä–æ—Å–æ–≤, 4500 –≤ –∫—ç—à–µ)
üìä –ì—Ä—É–ø–ø–∞ 3: –¥–æ–º–æ—Ñ–æ–Ω (3000 –∑–∞–ø—Ä–æ—Å–æ–≤, 3000 –≤ –∫—ç—à–µ)
üìä –ì—Ä—É–ø–ø–∞ 4: example (10 –∑–∞–ø—Ä–æ—Å–æ–≤, 0 –≤ –∫—ç—à–µ)

–ü—Ä–æ—Ü–µ—Å—Å:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ì—Ä—É–ø–ø–∞ 3: –ó–∞–≤–µ—Ä—à–µ–Ω–∞ —Å—Ä–∞–∑—É (100% –∫—ç—à)           ‚îÇ
‚îÇ –ì—Ä—É–ø–ø–∞ 4: 10 –∑–∞–ø—Ä–æ—Å–æ–≤, –±—ã—Å—Ç—Ä–æ                  ‚îÇ
‚îÇ –ì—Ä—É–ø–ø–∞ 2: 500 –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ API               ‚îÇ
‚îÇ –ì—Ä—É–ø–ø–∞ 1: 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ API              ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ –û–ë–©–ò–ô –ü–£–õ: 50 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤            ‚îÇ
‚îÇ - –ì—Ä—É–ø–ø–∞ 1: ~30 –∞–∫—Ç–∏–≤–Ω—ã—Ö                       ‚îÇ
‚îÇ - –ì—Ä—É–ø–ø–∞ 2: ~15 –∞–∫—Ç–∏–≤–Ω—ã—Ö                       ‚îÇ
‚îÇ - –ì—Ä—É–ø–ø–∞ 4: ~5 –∞–∫—Ç–∏–≤–Ω—ã—Ö                        ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ –ü–æ –º–µ—Ä–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–í—Ä–µ–º—è: ~30 –º–∏–Ω—É—Ç (–≤–º–µ—Å—Ç–æ 2 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ!)
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–µ—Ä–µ–∞–Ω–∞–ª–∏–∑ —Å –ø–æ–ª–Ω—ã–º –∫—ç—à–µ–º

```
üìä 4 –≥—Ä—É–ø–ø—ã, 10000 –∑–∞–ø—Ä–æ—Å–æ–≤
‚úì –í—Å–µ –≤ –∫—ç—à–µ!

–ü—Ä–æ—Ü–µ—Å—Å:
- API –∑–∞–ø—Ä–æ—Å–æ–≤: 0
- –í—Ä–µ–º—è: ~30 —Å–µ–∫—É–Ω–¥
- –°–µ–º–∞—Ñ–æ—Ä –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–∫—ç—à –Ω–µ —Ç—Ä–µ–±—É–µ—Ç API)
```

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### –í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã

–í –ª–æ–≥–∞—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
üîí –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–º–∞—Ñ–æ—Ä API: –º–∞–∫—Å–∏–º—É–º 50 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
...
‚ö° –ù—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å: 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
üìä –ê–Ω–∞–ª–∏–∑ SERP –¥–ª—è 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ (0 –∏–∑ –∫—ç—à–∞ + 1000 —á–µ—Ä–µ–∑ API)...
  [50/1000] –∫—É–ø–∏—Ç—å –¥–æ–º–æ—Ñ–æ–Ω –Ω–µ–¥–æ—Ä–æ–≥–æ...
  [100/1000] —Ü–µ–Ω–∞ –¥–æ–º–æ—Ñ–æ–Ω–∞...
  ...
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```python
import asyncio
from seo_analyzer.analysis.serp import get_api_semaphore

async def monitor():
    semaphore = get_api_semaphore()
    while True:
        stats = semaphore.get_stats()
        print(f"–ê–∫—Ç–∏–≤–Ω—ã—Ö: {stats['active_requests']}/50")
        await asyncio.sleep(5)

asyncio.run(monitor())
```

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. Singleton Pattern

–°–µ–º–∞—Ñ–æ—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑** –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```python
# –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ - —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–µ–º–∞—Ñ–æ—Ä
semaphore1 = get_api_semaphore(max_concurrent=50)

# –í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ—Ç –∂–µ —ç–∫–∑–µ–º–ø–ª—è—Ä
semaphore2 = get_api_semaphore()

# semaphore1 is semaphore2 == True
```

### 2. –ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –±–æ–ª—å—à–µ –∑–∞–¥–∞—á —á–µ–º –Ω—É–∂–Ω–æ

‚ùå **–ü–ª–æ—Ö–æ:**
```python
# 10000 –∑–∞–¥–∞—á –≤ asyncio.gather - –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç event loop
tasks = [fetch(q) for q in range(10000)]
await asyncio.gather(*tasks)
```

‚úÖ **–•–æ—Ä–æ—à–æ:**
```python
# –°–µ–º–∞—Ñ–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å
# –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ –∑–∞–¥–∞—á
tasks = [fetch(q) for q in range(10000)]
await asyncio.gather(*tasks)
# –ù–æ –∫ API –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ 50
```

### 3. –ö—ç—à –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ

```python
async def analyze_query(query):
    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
    cached = cache_manager.get(query)
    if cached:
        return cached  # –°–µ–º–∞—Ñ–æ—Ä –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!
    
    # 2. –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –≤ –∫—ç—à–µ - –∏–¥–µ–º –∫ API
    # –¢—É—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ–º–∞—Ñ–æ—Ä
    return await api_client.fetch_serp_data(query)
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∞–∫—Å–∏–º—É–º

```
50 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ √ó 10 —Å–µ–∫ –Ω–∞ –∑–∞–ø—Ä–æ—Å = 5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ √ó 60 —Å–µ–∫ √ó 60 –º–∏–Ω = 18000 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å
```

### –†–µ–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å

–° —É—á–µ—Ç–æ–º retry, –æ—à–∏–±–æ–∫, —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–¥–µ—Ä–∂–µ–∫:
- **~15000 –∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å**
- **~250 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É**

### –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∫—ç—à–∞

```
100% –∫—ç—à: 10000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 30 —Å–µ–∫
50% –∫—ç—à: 10000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 30 –º–∏–Ω (5000 —á–µ—Ä–µ–∑ API)
0% –∫—ç—à: 10000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 60 –º–∏–Ω
```

## üéØ Best Practices

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à

```python
SERP_CONFIG_OVERRIDES = {
    "use_database": True,      # SQLite –∫—ç—à
    "use_file_cache": True,    # –§–∞–π–ª–æ–≤—ã–π –∫—ç—à
    "cache_ttl_days": 30,      # –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ –∫—ç—à–∞
}
```

### 2. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –≥—Ä—É–ø–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

```bash
# ‚úÖ –•–æ—Ä–æ—à–æ
python main.py

# ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–æ
python main.py --sequential
```

### 3. –ù–µ –º–µ–Ω—è–π—Ç–µ max_concurrent –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã

50 –ø–æ—Ç–æ–∫–æ–≤ - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è XMLStock.  
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ - —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –∏—Ö —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.

### 4. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏

```python
stats = analyzer.serp_analyzer.get_statistics()
if stats['errors'] > 0:
    print(f"‚ö†Ô∏è  –û—à–∏–±–æ–∫: {stats['errors']}")
```

## üîó –°–º. —Ç–∞–∫–∂–µ

- [ASYNC_GROUPS_AND_TOP20.md](ASYNC_GROUPS_AND_TOP20.md) - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä—É–ø–ø
- [MULTI_GROUP_SYSTEM.md](guides/MULTI_GROUP_SYSTEM.md) - –°–∏—Å—Ç–µ–º–∞ –≥—Ä—É–ø–ø
- [XMLStock –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://xmlstock.com/api/) - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** –î–µ–∫–∞–±—Ä—å 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

