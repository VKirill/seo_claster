# SERP Status Tracking - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ üìä

## –ü—Ä–æ–±–ª–µ–º–∞ ‚ùå

–ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ SERP –¥–∞–Ω–Ω—ã—Ö:
- –ù–µ–ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∫–∞–∫–∏–µ –Ω–µ—Ç
- –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Å—ë —Å –Ω–∞—á–∞–ª–∞
- –ü–æ—Ç–µ—Ä—è –≤—Ä–µ–º–µ–Ω–∏ –∏ API –ª–∏–º–∏—Ç–æ–≤ xmlstock

## –†–µ—à–µ–Ω–∏–µ ‚úÖ

**Master DB** —Ç–µ–ø–µ—Ä—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ SERP –∑–∞–ø—Ä–æ—Å–∞:

```sql
master_queries (
    serp_req_id TEXT,              -- ID –∑–∞–ø—Ä–æ—Å–∞ –≤ xmlstock
    serp_status TEXT,               -- pending/processing/completed/error
    serp_error_message TEXT,        -- –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
    serp_created_at TIMESTAMP,      -- –ö–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
    serp_updated_at TIMESTAMP       -- –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
)
```

## –°—Ç–∞—Ç—É—Å—ã SERP –∑–∞–ø—Ä–æ—Å–æ–≤ üìã

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ß—Ç–æ –¥–µ–ª–∞—Ç—å |
|--------|----------|------------|
| `pending` | –ó–∞–ø—Ä–æ—Å –µ—â—ë –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ xmlstock | –î–æ–∂–¥–∞—Ç—å—Å—è –æ—á–µ—Ä–µ–¥–∏ |
| `processing` | –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –∂–¥—ë–º –æ—Ç–≤–µ—Ç–∞ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å req_id –≤ xmlstock |
| `completed` | –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| `error` | –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å error_message |

## Workflow üîÑ

### 1. –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏

```python
from seo_analyzer.core.cache.master_query_db import MasterQueryDatabase

master_db = MasterQueryDatabase()

# –û—Ç–º–µ—á–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∫ pending –ø–µ—Ä–µ–¥ –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π
keywords = ["–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã", "–º–æ–Ω—Ç–∞–∂ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è", ...]
master_db.mark_serp_as_pending("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", keywords)

# ‚úì –û—Ç–º–µ—á–µ–Ω–æ 56923 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–∞–∫ pending –¥–ª—è SERP –∑–∞–≥—Ä—É–∑–∫–∏
```

### 2. –í–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏

```python
# –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞
master_db.update_serp_status(
    group_name="–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
    keyword="–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã",
    status="processing",
    req_id="12345678"  # ID –æ—Ç xmlstock
)

# –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
master_db.update_serp_status(
    group_name="–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
    keyword="–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã",
    status="completed"
)

# –ü—Ä–∏ –æ—à–∏–±–∫–µ
master_db.update_serp_status(
    group_name="–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
    keyword="–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã",
    status="error",
    error_message="Timeout –ø–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫"
)
```

### 3. –ü–æ—Å–ª–µ –ø–∞–¥–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞

```bash
python recover_serp_requests.py
```

**–í—ã–≤–æ–¥:**
```
================================================================================
–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö SERP –∑–∞–ø—Ä–æ—Å–æ–≤
================================================================================

–ù–∞–π–¥–µ–Ω–æ –≥—Ä—É–ø–ø: 3

‚ö†Ô∏è  –ù–∞–π–¥–µ–Ω–æ 15,432 –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö SERP –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 2 –≥—Ä—É–ø–ø–∞—Ö:

1. –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ
   ‚Ä¢ –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: 56,923
   ‚Ä¢ –ó–∞–≤–µ—Ä—à–µ–Ω–æ: 41,491 (72.9%)
   ‚Ä¢ Pending: 12,234
   ‚Ä¢ Processing: 3,198

2. —Å–∫—É–¥
   ‚Ä¢ –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: 23,456
   ‚Ä¢ –ó–∞–≤–µ—Ä—à–µ–Ω–æ: 23,456 (100.0%)
   ‚Ä¢ Pending: 0
   ‚Ä¢ Processing: 0

–ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:

1Ô∏è‚É£  –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
2Ô∏è‚É£  –°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç—É—Å pending ‚Üí completed (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –µ—Å—Ç—å)
3Ô∏è‚É£  –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ–∫–∞—á–∫—É —á–µ—Ä–µ–∑ main.py --resume-serp
0Ô∏è‚É£  –í—ã—Ö–æ–¥
```

### 4. –î–æ–∫–∞—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–∫–∞—á–∞—Ç—å –í–°–ï –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
python main.py --force-serp

# –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–∫–∞—á–∞—Ç—å –¢–û–õ–¨–ö–û pending (–±–µ–∑ processing)
python main.py --resume-pending
```

## API –º–µ—Ç–æ–¥—ã üõ†Ô∏è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö

```python
pending = master_db.get_pending_serp_queries("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ")

for item in pending:
    print(f"{item['keyword']} - {item['serp_status']}")
    if item['serp_req_id']:
        print(f"  req_id: {item['serp_req_id']}")
    if item['serp_error_message']:
        print(f"  –æ—à–∏–±–∫–∞: {item['serp_error_message']}")
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥—Ä—É–ø–ø–µ

```python
stats = master_db.get_serp_statistics("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ")

print(f"–í—Å–µ–≥–æ: {stats['total']:,}")
print(f"–ó–∞–≤–µ—Ä—à–µ–Ω–æ: {stats['completed']:,} ({stats['completion_rate']:.1%})")
print(f"Pending: {stats['pending']:,}")
print(f"Processing: {stats['processing']:,}")
print(f"–û—à–∏–±–æ–∫: {stats['error']:,}")
print(f"–° –¥–∞–Ω–Ω—ã–º–∏: {stats['with_data']:,}")
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

```python
# –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ pending
master_db.mark_serp_as_pending("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", ["–∑–∞–ø—Ä–æ—Å1", "–∑–∞–ø—Ä–æ—Å2"])

# –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
master_db.update_serp_status(
    group_name="–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
    keyword="–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã",
    status="completed"
)

# –° req_id
master_db.update_serp_status(
    group_name="–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
    keyword="–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã",
    status="processing",
    req_id="12345678"
)

# –° –æ—à–∏–±–∫–æ–π
master_db.update_serp_status(
    group_name="–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",
    keyword="–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã",
    status="error",
    error_message="API limit exceeded"
)
```

## –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ üöÄ

```sql
-- –ü–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ç—É—Å—É + req_id
CREATE INDEX idx_master_serp_status 
ON master_queries(serp_status, serp_req_id)

-- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –ø–æ –≥—Ä—É–ø–ø–µ
CREATE INDEX idx_master_serp_pending 
ON master_queries(group_name, serp_status)
```

**–°–∫–æ—Ä–æ—Å—Ç—å:** –ü–æ–∏—Å–∫ 15,000 –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ = **3 ms** ‚ö°

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è üìù

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–∫—Ä–∏–ø—Ç —É–ø–∞–ª –≤–æ –≤—Ä–µ–º—è SERP –∞–Ω–∞–ª–∏–∑–∞

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
python recover_serp_requests.py
# ‚Üí –ù–∞–π–¥–µ–Ω–æ 15,432 –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö

# 2. –î–æ–∫–∞—á–∏–≤–∞–µ–º
python main.py --force-serp
# ‚Üí –ó–∞–≥—Ä—É–∂–µ–Ω–æ 15,432 –Ω–æ–≤—ã—Ö SERP –∑–∞–ø–∏—Å–µ–π

# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º
python recover_serp_requests.py
# ‚Üí ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: API –ª–∏–º–∏—Ç xmlstock –∏—Å—á–µ—Ä–ø–∞–Ω

```bash
# 1. –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π "API limit"
# –°—Ç–∞—Ç—É—Å –º–Ω–æ–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: processing

# 2. –ñ–¥—ë–º —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–∞ (—Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å)

# 3. –î–æ–∫–∞—á–∏–≤–∞–µ–º –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
python main.py --resume-pending
# ‚Üí –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç completed, –∑–∞–≥—Ä—É–∂–∞–µ—Ç pending/processing
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –•–æ—Ç–∏–º –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å SERP –¥–ª—è —á–∞—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

```python
# –û—Ç–º–µ—á–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∫ pending
master_db = MasterQueryDatabase()

queries_to_refresh = ["–∫—É–ø–∏—Ç—å –∫–∞–º–µ—Ä—ã", "–º–æ–Ω—Ç–∞–∂ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è"]
master_db.mark_serp_as_pending("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", queries_to_refresh)

# –ó–∞–ø—É—Å–∫–∞–µ–º –¥–æ–∫–∞—á–∫—É
# python main.py --resume-pending
```

## –û—Ç–ª–∏—á–∏–µ –æ—Ç serp_data.db ‚öñÔ∏è

| –§–∏—á–∞ | serp_data.db | Master DB |
|------|--------------|-----------|
| –•—Ä–∞–Ω–∏—Ç XML | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é | ‚ùå –ù–µ—Ç (—Ç–æ–ª—å–∫–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) |
| –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏ | ‚úÖ req_id + status | ‚úÖ serp_status + req_id |
| –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ | ‚úÖ –ü–æ req_id | ‚úÖ –ü–æ serp_status |
| –†–∞–∑–º–µ—Ä | 2 GB (XML —Ç—è–∂—ë–ª—ã–µ) | 200 MB (—Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ) |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | –û—Ç–¥–µ–ª—å–Ω–∞—è –ë–î | –í—Å—ë –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ |

**–í—ã–≤–æ–¥:** `serp_data.db` –º–æ–∂–Ω–æ **—É–±—Ä–∞—Ç—å**, Master DB –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å—ë! ‚úÖ

## –ú–∏–≥—Ä–∞—Ü–∏—è: —É–±–∏—Ä–∞–µ–º serp_data.db üîÑ

### –®–∞–≥ 1: –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–∞—Ä—Å–∏–º XML –∏–∑ serp_data.db ‚Üí Master DB
python migrate_serp_to_master.py
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

–í `seo_analyzer/analysis/serp/cache_manager.py`:

```python
# –ë–´–õ–û:
self.database = SERPDatabase(db_path=db_path)  # serp_data.db

# –°–¢–ê–õ–û:
self.master_db = MasterQueryDatabase()  # master_queries.db
```

### –®–∞–≥ 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é –≤ Master DB

```python
# –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ SERP –¥–∞–Ω–Ω—ã—Ö
api_result = await fetch_from_xmlstock(query)

# –ü–∞—Ä—Å–∏–º XML ‚Üí –∏–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ
parsed = parse_serp_xml(api_result['xml_response'])

# –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ Master DB
master_db.update_serp_status(
    group_name=group_name,
    keyword=query,
    status='completed',
    req_id=api_result['req_id']
)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (top_urls, lsi –∏ —Ç.–¥.)
# —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π save_queries –≤ –∫–æ–Ω—Ü–µ pipeline
```

### –®–∞–≥ 4: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π –ë–î

```bash
# –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
del output\serp_data.db  # 2 GB –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è!
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚ö°

```bash
python check_db_performance.py
```

**–ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã:**
```
üìä SERP Status Tracking
  üîç –ü–æ–∏—Å–∫ pending –∑–∞–ø—Ä–æ—Å–æ–≤: 2.3 ms
  üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≥—Ä—É–ø–ø–µ: 1.8 ms
  üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞: 0.5 ms
```

## Troubleshooting üîß

### –ú–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ "processing"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–∫—Ä–∏–ø—Ç —É–ø–∞–ª –≤–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç xmlstock

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å req_id –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ xmlstock
# 2. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã - —Å–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç—É—Å
python recover_serp_requests.py
# ‚Üí –í—ã–±—Ä–∞—Ç—å –æ–ø—Ü–∏—é 2 (—Å–±—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞)

# 3. –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
python main.py --force-serp
```

### "API limit exceeded" –¥–ª—è –º–Ω–æ–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–∏—á–∏–Ω–∞:** –ò—Å—á–µ—Ä–ø–∞–Ω –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç xmlstock

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –î–æ–∂–¥–∞—Ç—å—Å—è —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–∞, –∑–∞—Ç–µ–º:
python main.py --resume-pending
# –ó–∞–≥—Ä—É–∑–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ
```

### –•–æ—á—É –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å SERP –¥–ª—è –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø—ã

```python
from seo_analyzer.core.cache.master_query_db import MasterQueryDatabase

master_db = MasterQueryDatabase()

# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≥—Ä—É–ø–ø—ã
import sqlite3
conn = sqlite3.connect("output/master_queries.db")
cursor = conn.execute(
    "SELECT keyword FROM master_queries WHERE group_name = ?",
    ("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ",)
)
keywords = [row[0] for row in cursor.fetchall()]
conn.close()

# –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ pending
master_db.mark_serp_as_pending("–≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", keywords)

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ–∫–∞—á–∫—É
# python main.py --resume-pending
```

## –°–º. —Ç–∞–∫–∂–µ üìö

- [MASTER_DB_INTEGRATION.md](MASTER_DB_INTEGRATION.md) - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Master DB
- [DATABASE_INDEXES_GUIDE.md](DATABASE_INDEXES_GUIDE.md) - –ò–Ω–¥–µ–∫—Å—ã
- `recover_serp_requests.py` - –°–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

---

**–í–æ–ø—Ä–æ—Å—ã?** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python recover_serp_requests.py`

