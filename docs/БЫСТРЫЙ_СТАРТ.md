# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - SERP + KEI + Excel

## ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞. –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

**–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã:**
- `aiohttp` - –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ xmlstock API
- `xlsxwriter` - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Excel —Ñ–∞–π–ª–æ–≤
- `openpyxl` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel

## üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞ xmlstock

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: config_local.py**

```bash
# 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω
copy config_local.py.example config_local.py

# 2. –û—Ç–∫—Ä–æ–π—Ç–µ config_local.py –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π –∫–ª—é—á
# XMLSTOCK_API_KEY = "–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å"

# 3. –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ --xmlstock-api-key
python main.py data.csv --enable-serp
```

**‚ö†Ô∏è –§–∞–π–ª config_local.py —É–∂–µ –≤ .gitignore - –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ GitHub!**

–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é: [–ö–ê–ö_–ù–ê–°–¢–†–û–ò–¢–¨_API_–ö–õ–Æ–ß.md](–ö–ê–ö_–ù–ê–°–¢–†–û–ò–¢–¨_API_–ö–õ–Æ–ß.md)

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã

```bash
python test_serp_kei_integration.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 6/6 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ ‚úÖ

## üìä –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### ‚ö° –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—É—Å–∫ (SERP –∞–Ω–∞–ª–∏–∑ –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù)

**–í–ù–ò–ú–ê–ù–ò–ï:** –¢–µ–ø–µ—Ä—å SERP –∞–Ω–∞–ª–∏–∑ –≤–∫–ª—é—á–µ–Ω –≤—Å–µ–≥–¥–∞! API –∫–ª—é—á –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã.

```bash
# –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫ (–∫–ª—é—á –∏–∑ config_local.py)
# –°–æ–±–µ—Ä—ë—Ç –í–°–ï –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—è –∫—ç—à + –º–∞–∫—Å–∏–º—É–º 500 –Ω–æ–≤—ã—Ö —á–µ—Ä–µ–∑ API
python main.py semantika/—Å–∫—É–¥.csv

# –°–æ–±—Ä–∞—Ç—å –í–°–ï –∑–∞–ø—Ä–æ—Å—ã (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π API)
python main.py semantika/—Å–∫—É–¥.csv --max-serp-queries 999999

# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –Ω–æ–≤—ã–µ API –∑–∞–ø—Ä–æ—Å—ã (–∫—ç—à –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞)
python main.py semantika/—Å–∫—É–¥.csv --max-serp-queries 100
```

**–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç–µ:**
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ SERP –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –í–°–ï–• –∑–∞–ø—Ä–æ—Å–æ–≤ (–∫—ç—à + API)
- ‚úÖ LSI —Ñ—Ä–∞–∑—ã –∏–∑ TOP-30 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ 18 KEI —Ñ–æ—Ä–º—É–ª –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ Excel —Ñ–∞–π–ª —Å 5 –ª–∏—Å—Ç–∞–º–∏
- ‚úÖ SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ –≤—Å–µ–º–∏ SERP –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ CSV —Ñ–∞–π–ª—ã —Å –ø–æ–ª–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ HTML –¥–∞—à–±–æ—Ä–¥

**üöÄ –£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
- –ó–∞–ø—Ä–æ—Å—ã –≤ –∫—ç—à–µ (< 30 –¥–Ω–µ–π) ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –ù–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚Üí —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ API (–ª–∏–º–∏—Ç `--max-serp-queries`)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–∞–∫—Å–∏–º—É–º –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –º–∏–Ω–∏–º—É–º–µ API –∑–∞–ø—Ä–æ—Å–æ–≤!

### üöÄ –ü–æ–ª–Ω—ã–π pipeline

```bash
python main.py semantika/—Å–∫—É–¥.csv \
  --max-serp-queries 500 \
  --soft-clustering \
  --enable-graph \
  --enable-word-match
```

### üî§ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º —Å–ª–æ–≤ (NEW!)

**–ê–Ω–∞–ª–æ–≥ KeyCollector:** –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Ñ—Ä–∞–∑—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —Å–ª–æ–≤.

```bash
# –ë–∞–∑–æ–≤–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (—Å–∏–ª–∞=2, –º–∏–Ω.—Ä–∞–∑–º–µ—Ä=2)
python main.py semantika/—Å–∫—É–¥.csv --enable-word-match

# –°—Ç—Ä–æ–≥–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ –±–ª–∏–∑–∫–∏–µ —Ñ—Ä–∞–∑—ã)
python main.py semantika/—Å–∫—É–¥.csv \
  --enable-word-match \
  --word-match-strength 3 \
  --word-match-min-size 5

# –ú—è–≥–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ö–≤–∞—Ç)
python main.py semantika/—Å–∫—É–¥.csv \
  --enable-word-match \
  --word-match-strength 1 \
  --word-match-min-size 1
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--word-match-strength N` ‚Äî –º–∏–Ω–∏–º—É–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 2)
- `--word-match-min-size N` ‚Äî –º–∏–Ω–∏–º—É–º —Ñ—Ä–∞–∑ –≤ –≥—Ä—É–ø–ø–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 2)
- `--word-match-strengthen` ‚Äî —É—Å–∏–ª–∏–≤–∞—Ç—å —Å–≤—è–∑–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≤–∫–ª—é—á–µ–Ω–æ)
- `--word-match-no-strengthen` ‚Äî –æ—Ç–∫–ª—é—á–∏—Ç—å —É—Å–∏–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 2 –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ CSV:
- `word_match_cluster_id` ‚Äî ID –≥—Ä—É–ø–ø—ã
- `word_match_cluster_name` ‚Äî –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã (—Ñ—Ä–∞–∑–∞ —Å max !—á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç—å—é)

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ: [–ì–†–£–ü–ü–ò–†–û–í–ö–ê_–ü–û_–°–õ–û–í–ê–ú.md](–ì–†–£–ü–ü–ò–†–û–í–ö–ê_–ü–û_–°–õ–û–í–ê–ú.md)

## üóÑÔ∏è SQLite –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ù–µ –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ xmlstock API!

```
–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫:  500 API –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí 5-10 –º–∏–Ω—É—Ç
–í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫:  0 API –∑–∞–ø—Ä–æ—Å–æ–≤   ‚Üí 10-20 —Å–µ–∫—É–Ω–¥ (–∏–∑ –ë–î!)
```

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `output/serp_data.db`

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```python
from seo_analyzer.core.serp_database import SERPDatabase

db = SERPDatabase()

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = db.get_statistics()
print(f"–ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –ë–î: {stats['total_queries']}")
print(f"–†–∞–∑–º–µ—Ä –ë–î: {stats['db_size_mb']} MB")

# –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
db.clear_old_data(days=30)
```

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤ output/

```
output/
‚îú‚îÄ‚îÄ serp_data.db                    # ‚≠ê SQLite –ë–î —Å–æ –≤—Å–µ–º–∏ SERP –¥–∞–Ω–Ω—ã–º–∏
‚îú‚îÄ‚îÄ seo_analysis.xlsx               # ‚≠ê Excel —Å 5 –ª–∏—Å—Ç–∞–º–∏
‚îú‚îÄ‚îÄ cluster_lsi_phrases.csv         # ‚≠ê LSI —Ñ—Ä–∞–∑—ã –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º
‚îú‚îÄ‚îÄ seo_analysis_full.csv           # –ü–æ–ª–Ω—ã–π CSV —Å KEI –º–µ—Ç—Ä–∏–∫–∞–º–∏
‚îú‚îÄ‚îÄ seo_analysis_top1000.csv
‚îú‚îÄ‚îÄ clusters_summary.csv
‚îú‚îÄ‚îÄ brands.csv
‚îú‚îÄ‚îÄ dashboard.html
‚îî‚îÄ‚îÄ statistics.json
```

### Excel —Ñ–∞–π–ª (5 –ª–∏—Å—Ç–æ–≤)

1. **All Queries** - –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π
2. **Top Priority** - —Ç–æ–ø-100 –ø–æ priority_score
3. **Clusters Summary** - —Å–≤–æ–¥–∫–∞ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º
4. **Intent Summary** - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∏–Ω—Ç–µ–Ω—Ç–∞–º
5. **LSI Phrases** - LSI —Ñ—Ä–∞–∑—ã –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

## üéØ –ù–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### KEI —Ñ–æ—Ä–º—É–ª—ã (18 —à—Ç—É–∫)

**–í CSV –∫–æ–ª–æ–Ω–∫–∏:**
- `kei_effectiveness` - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ (‚Üë –ª—É—á—à–µ)
- `kei_competition` - —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ (‚Üì –ª—É—á—à–µ)
- `kei_standard`, `kei_devaka`, `kei_coefficient`...
- `priority_score` - **–∏—Ç–æ–≥–æ–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–≥–ª–∞–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞)**

### SERP –º–µ—Ç—Ä–∏–∫–∏

- `serp_docs_count` - –Ω–∞–π–¥–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `serp_main_pages` - –≥–ª–∞–≤–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –≤ TOP-30
- `serp_titles_count` - title —Å —Ç–æ—á–Ω—ã–º –≤—Ö–æ–∂–¥–µ–Ω–∏–µ–º
- `serp_commercial_domains` - –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤
- `serp_info_domains` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤

### LSI —Ñ—Ä–∞–∑—ã

- `cluster_lsi_phrases` - —Ç–æ–ø-5 LSI —Ñ—Ä–∞–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞ (—Å—Ç—Ä–æ–∫–∞)
- –í –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ: `cluster_lsi_phrases.csv` (–¥–µ—Ç–∞–ª—å–Ω–æ)

## üåç –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≥–µ–æ-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

**–¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**

```
‚ùå –ë—ã–ª–æ: "—Å–∏—Å—Ç–µ–º—ã —Å–∫—É–¥ —Ä–æ—Å—Ç–æ–≤" ‚Üí –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è–ª—Å—è –∫–∞–∫ geo
‚úÖ –°—Ç–∞–ª–æ: "—Å–∏—Å—Ç–µ–º—ã —Å–∫—É–¥ —Ä–æ—Å—Ç–æ–≤ –Ω–∞ –¥–æ–Ω—É" ‚Üí commercial, geo_city="–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É"
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:**
1. Russian.txt - —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –≥–æ—Ä–æ–¥–∞ (—Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ —Å–ª–æ–≤)
2. Moscow.txt - –≤–∞—Ä–∏–∞–Ω—Ç—ã –ú–æ—Å–∫–≤—ã
3. Kazakhstan/Belarus/Ukraine
4. Country - –æ–±—â–∏–µ —Ç–µ—Ä–º–∏–Ω—ã

**–í—Å–µ –≥–µ–æ-–∑–∞–ø—Ä–æ—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ commercial!**

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ù–∞—á–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (—Ç–æ–ø-100 –∑–∞–ø—Ä–æ—Å–æ–≤)

```bash
# SERP –∞–Ω–∞–ª–∏–∑ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–ø-100 (–±—ã—Å—Ç—Ä–æ)
python main.py semantika/—Å–∫—É–¥.csv --max-serp-queries 100
```

–ó–∞—Ç–µ–º —Ä–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ 500:

```bash
python main.py semantika/—Å–∫—É–¥.csv --max-serp-queries 500
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ (–∏–∑ –∫—ç—à–∞)

```bash
# –ü–µ—Ä–≤—ã–π —Ä–∞–∑ - –º–µ–¥–ª–µ–Ω–Ω–æ (API –∑–∞–ø—Ä–æ—Å—ã)
python main.py semantika/—Å–∫—É–¥.csv --max-serp-queries 500

# –í—Ç–æ—Ä–æ–π —Ä–∞–∑ - –ë–´–°–¢–†–û (–∏–∑ –ë–î, –±–µ–∑ API –∑–∞–ø—Ä–æ—Å–æ–≤!)
python main.py semantika/—Å–∫—É–¥.csv --max-serp-queries 500
```

Cache hit rate –±—É–¥–µ—Ç ~80-100%! ‚ö°

### –ü—Ä–∏–º–µ—Ä 3: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å KEI —Ñ–æ—Ä–º—É–ª–∞–º–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ (–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î)
2. –ò–∑–º–µ–Ω–∏—Ç—å –≤–µ—Å–∞ –≤ `seo_analyzer/core/config.py`:

```python
priority_weights = {
    'frequency': 0.4,      # –ë—ã–ª–æ 0.3
    'difficulty': 0.2,     # –ë—ã–ª–æ 0.25
    'commercial': 0.2,     # –ë—ã–ª–æ 0.25
    'kei_effectiveness': 0.2
}
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–Ω–æ–≤–∞ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î, –±–µ–∑ –Ω–æ–≤—ã—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤!)
4. –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π priority_score –±–µ–∑ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ API!

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **SERP_KEI_EXCEL_GUIDE.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –í—Å–µ KEI —Ñ–æ—Ä–º—É–ª—ã —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏
   - SQLite –ë–î –ø–æ–¥—Ä–æ–±–Ω–æ
   - Excel —ç–∫—Å–ø–æ—Ä—Ç
   - Use cases –∏ best practices
   - API reference
   - Troubleshooting

2. **IMPLEMENTATION_SUMMARY.md** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–≤–æ–¥–∫–∞
   - –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (checklist)
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–¥–∞

3. **–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª) - –Ω–∞—á–∞—Ç—å –∑–¥–µ—Å—å!

## üîß CLI –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

### SERP –∏ KEI (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´)

```bash
--xmlstock-api-key USER:KEY    # API –∫–ª—é—á (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å config_local.py)
--max-serp-queries 500         # –ú–∞–∫—Å –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è SERP (default: 500)

# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: SERP –∏ KEI —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω—ã!
```

### Excel

```bash
--skip-excel                   # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å Excel
--excel-with-charts            # –ì—Ä–∞—Ñ–∏–∫–∏ –≤ Excel (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ)
```

### –î—Ä—É–≥–æ–µ

```bash
--soft-clustering              # –ù–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–º –Ω–∞ –∑–∞–ø—Ä–æ—Å
--enable-graph                 # –ì—Ä–∞—Ñ —Å–≤—è–∑–µ–π (–º–µ–¥–ª–µ–Ω–Ω–æ)
--skip-topics                  # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å topic modeling
--skip-hierarchical            # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é
--skip-forms                   # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–∞–¥–µ–∂–Ω—ã–µ —Ñ–æ—Ä–º—ã
```

## ‚ùì FAQ

### –ù—É–∂–µ–Ω –ª–∏ API –∫–ª—é—á –¥–ª—è —Ä–∞–±–æ—Ç—ã?

**–î–∞!** –¢–µ–ø–µ—Ä—å SERP –∞–Ω–∞–ª–∏–∑ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ API –∫–ª—é—á –æ–¥–∏–Ω —Ä–∞–∑:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ config_local.py
copy config_local.py.example config_local.py
# –í—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π –∫–ª—é—á

# –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç
python main.py data.csv
```

### –°–∫–æ–ª—å–∫–æ —Å—Ç–æ—è—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ xmlstock?

–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∞—Ä–∏—Ñ–∞. –û–±—ã—á–Ω–æ ~1-5 —Ä—É–± –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤.

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫–æ–Ω–æ–º–∏—Ç –¥–µ–Ω—å–≥–∏:**
- –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫: 500 –∑–∞–ø—Ä–æ—Å–æ–≤ = 2.5 —Ä—É–±
- –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ: 0 –∑–∞–ø—Ä–æ—Å–æ–≤ = 0 —Ä—É–± (–∏–∑ –ë–î)

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç priority_score?

```
priority_score = 
  normalized(frequency) * 0.3 +       # –ß–µ–º –±–æ–ª—å—à–µ —á–∞—Å—Ç–æ—Ç–∞ = –ª—É—á—à–µ
  (100 - difficulty) * 0.25 +          # –ß–µ–º –º–µ–Ω—å—à–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å = –ª—É—á—à–µ
  normalized(commercial_score) * 0.25 + # –ß–µ–º –≤—ã—à–µ –∫–æ–º–º–µ—Ä—Ü–∏—è = –ª—É—á—à–µ
  normalized(kei_effectiveness) * 0.20  # –ß–µ–º –≤—ã—à–µ KEI = –ª—É—á—à–µ
```

**–í Excel:** –ª–∏—Å—Ç "Top Priority" - –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ —ç—Ç–æ–π –º–µ—Ç—Ä–∏–∫–µ

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å LSI —Ñ—Ä–∞–∑–∞–º–∏?

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞:**

1. –û—Ç–∫—Ä—ã—Ç—å `cluster_lsi_phrases.csv`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤–∑—è—Ç—å —Ç–æ–ø-10 —Ñ—Ä–∞–∑
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫:
   - –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ H2/H3
   - –ê–±–∑–∞—Ü—ã —Ç–µ–∫—Å—Ç–∞
   - Meta description
   - Alt —Ç–µ–≥–∏

**–ü—Ä–∏–º–µ—Ä –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∞ "—Å–∏—Å—Ç–µ–º—ã —Å–∫—É–¥":**
```
LSI —Ñ—Ä–∞–∑—ã:
- —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
- —Ç—É—Ä–Ω–∏–∫–µ—Ç—ã –æ–≥—Ä–∞–∂–¥–µ–Ω–∏—è
- –±–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –º–æ–Ω—Ç–∞–∂ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

‚Üí –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª—ã —Å—Ç–∞—Ç—å–∏ —Å —ç—Ç–∏–º–∏ —Ç–µ–º–∞–º–∏
```

### –ö–∞–∫ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥ API –ª–∏–º–∏—Ç–æ–≤?

**–ü–∞—Ä–∞–º–µ—Ç—Ä `--max-serp-queries` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ù–û–í–´–ï API –∑–∞–ø—Ä–æ—Å—ã (–∫—ç—à –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è):**

```bash
# –ú–∞–∫—Å–∏–º—É–º 100 –ù–û–í–´–• –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API (+ –≤—Å–µ –∏–∑ –∫—ç—à–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
python main.py data.csv --max-serp-queries 100

# –ú–∞–∫—Å–∏–º—É–º 1000 –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
python main.py data.csv --max-serp-queries 1000

# –°–æ–±—Ä–∞—Ç—å –í–°–ï –∑–∞–ø—Ä–æ—Å—ã (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
python main.py data.csv --max-serp-queries 999999
```

**–ü—Ä–∏–º–µ—Ä:**
```
–§–∞–π–ª: 5,000 –∑–∞–ø—Ä–æ—Å–æ–≤
–í –∫—ç—à–µ: 3,000 –∑–∞–ø—Ä–æ—Å–æ–≤
--max-serp-queries 500

–†–µ–∑—É–ª—å—Ç–∞—Ç:
‚úì –ò–∑ –∫—ç—à–∞: 3,000 –∑–∞–ø—Ä–æ—Å–æ–≤ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
‚úì –ß–µ—Ä–µ–∑ API: 500 –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ç–æ–ø –ø–æ —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç–∏)
‚úì –ò—Ç–æ–≥–æ —Å SERP: 3,500 –∑–∞–ø—Ä–æ—Å–æ–≤
‚úó –ë–µ–∑ SERP: 1,500 –∑–∞–ø—Ä–æ—Å–æ–≤ (–æ—Å—Ç–∞–ª—å–Ω—ã–µ)
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ç–µ—Ç —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ?

**–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

```python
from seo_analyzer.core.serp_database import SERPDatabase

db = SERPDatabase()

# –£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 15 –¥–Ω–µ–π
deleted = db.clear_old_data(days=15)
print(f"–£–¥–∞–ª–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π: {deleted}")
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª `output/serp_data.db`

## üéì –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ù–∞—á–Ω–∏—Ç–µ —Å –º–∞–ª–æ–≥–æ

```bash
# –î–µ–Ω—å 1: –¢–æ–ø-100 –∑–∞–ø—Ä–æ—Å–æ–≤ (–±—ã—Å—Ç—Ä–æ, —ç–∫–æ–Ω–æ–º–∏—è API)
python main.py data.csv --max-serp-queries 100

# –î–µ–Ω—å 2: –†–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ 500
python main.py data.csv --max-serp-queries 500

# –î–µ–Ω—å 3: –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã)
python main.py data.csv --max-serp-queries 10000
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Excel

**–õ–∏—Å—Ç "Top Priority"** - –Ω–∞—á–Ω–∏—Ç–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ —Å —ç—Ç–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤!

–§–∏–ª—å—Ç—Ä—ã:
- `kei_effectiveness` > 50 (–≤—ã—Å–æ–∫–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
- `kei_competition` < 30 (–Ω–∏–∑–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è)
- `frequency_world` > 100 (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞)

### 3. –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–Ω—Ç

**–õ–∏—Å—Ç "Clusters Summary":**
1. –í—ã–±—Ä–∞—Ç—å —Ç–æ–ø-10 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ø–æ frequency
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LSI —Ñ—Ä–∞–∑—ã –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—É

**–õ–∏—Å—Ç "LSI Phrases":**
- –¢–æ–ø-10 —Ñ—Ä–∞–∑ = —Ä–∞–∑–¥–µ–ª—ã —Å—Ç–∞—Ç—å–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∏ —Ç–µ–∫—Å—Ç–µ

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü —Å —Ç–µ–º –∂–µ —Ñ–∞–π–ª–æ–º:

```bash
python main.py data.csv --max-serp-queries 500
```

–°—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ `difficulty_score` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ä–æ—Å—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏.  
**–î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î:** –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –º–ª–∞–¥—à–µ 30 –¥–Ω–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à (–±–µ—Å–ø–ª–∞—Ç–Ω–æ!).

## üéâ –ì–æ—Ç–æ–≤–æ!

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.**

**–ù–∞—á–Ω–∏—Ç–µ —Å:**
```bash
# 1. –û–¥–∏–Ω —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ API –∫–ª—é—á
copy config_local.py.example config_local.py
# (–æ—Ç–∫—Ä–æ–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á)

# 2. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ
python main.py semantika/—Å–∫—É–¥.csv --max-serp-queries 500
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 10-15 –º–∏–Ω—É—Ç:**
- ‚úÖ SQLite –ë–î —Å SERP –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ 18 KEI —Ñ–æ—Ä–º—É–ª
- ‚úÖ LSI —Ñ—Ä–∞–∑—ã –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º
- ‚úÖ Excel —Å 5 –ª–∏—Å—Ç–∞–º–∏
- ‚úÖ Priority score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

**–û—Ç–∫—Ä–æ–π—Ç–µ `output/seo_analysis.xlsx` –∏ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å!**

---

üìû **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
- GitHub Issues
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: SERP_KEI_EXCEL_GUIDE.md

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2025-12-07  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ

