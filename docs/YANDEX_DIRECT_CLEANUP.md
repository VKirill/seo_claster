# üßπ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ Yandex Direct

## üìå –ü—Ä–æ–±–ª–µ–º–∞

Yandex Direct API –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–≥–Ω–æ–∑–æ–≤. –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª—è—Ç—å –∏—Ö –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —ç—Ç–æ –º–æ–∂–µ—Ç:
- –ó–∞–º–µ–¥–ª—è—Ç—å API
- –ó–∞—Ö–ª–∞–º–ª—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
- –†–∞—Å—Ö–æ–¥–æ–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã —Å–µ—Ä–≤–µ—Ä–∞

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–∞, —Å–∏—Å—Ç–µ–º–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –µ–≥–æ** —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `DeleteForecastReport`.

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. –ú–µ—Ç–æ–¥ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞

**–§–∞–π–ª:** `seo_analyzer/analysis/yandex_direct_client.py`

```python
def delete_forecast(self, forecast_id: int, debug: bool = False) -> bool:
    """
    –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
    
    Args:
        forecast_id: ID –ø—Ä–æ–≥–Ω–æ–∑–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
        debug: –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        
    Returns:
        True –µ—Å–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
    """
```

### 2. API –∑–∞–ø—Ä–æ—Å

**URL:** `https://api-sandbox.direct.yandex.ru/live/v4/json/`

**–ú–µ—Ç–æ–¥:** POST

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "method": "DeleteForecastReport",
  "token": "YOUR_OAUTH_TOKEN",
  "param": FORECAST_ID
}
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤

**–§–∞–π–ª:** `seo_analyzer/analysis/yandex_direct_enricher.py`

```python
forecast_id = None
try:
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞
    forecast_id = self.client.create_forecast(batch, debug=debug_mode)
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    forecast_data = self.client.get_forecast(forecast_id, debug=debug_mode)
    
    # –ü–∞—Ä—Å–∏–Ω–≥ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    parsed_data = self.parser.parse_forecast_response(forecast_data)
    # ...
    
    # ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    if forecast_id:
        self.client.delete_forecast(forecast_id, debug=debug_mode)
        
except Exception as e:
    # ‚ö†Ô∏è –î–∞–∂–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –ø—ã—Ç–∞–µ–º—Å—è —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑
    if forecast_id:
        try:
            self.client.delete_forecast(forecast_id, debug=False)
        except:
            pass
```

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** ‚Äî –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏
- **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** ‚Äî API —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Debug —Ä–µ–∂–∏–º** ‚Äî –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∫–æ–≥–¥–∞ –ø—Ä–æ–≥–Ω–æ–∑—ã —É–¥–∞–ª—è—é—Ç—Å—è

### üìã –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π

1. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞** (`CreateNewForecast`)
   - –ü–æ–ª—É—á–∞–µ–º `forecast_id`
   
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** (`GetForecast`)
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º `forecast_id`
   - –ü–∞—Ä—Å–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   
3. **–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞** (`DeleteForecastReport`) ‚ú® **–ù–û–í–û–ï**
   - –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã API
   - –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é

### üîç Debug —Ä–µ–∂–∏–º

–í–∫–ª—é—á–∏—Ç–µ debug –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è:

```bash
$env:YANDEX_DIRECT_DEBUG="1"
python main.py
```

–í—ã–≤–æ–¥:
```
‚úÖ –ü—Ä–æ–≥–Ω–æ–∑ 16770729 —É–¥–∞–ª–µ–Ω
```

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ï—Å–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å:
```
‚ö†Ô∏è  –ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ 16770729: API error
```

**–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É** ‚Äî –æ—à–∏–±–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –∞–Ω–∞–ª–∏–∑.

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- –ü—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞–ª–∏—Å—å –≤ API
- –ò—Å—Ç–æ—Ä–∏—è –∑–∞—Å–æ—Ä—è–ª–∞—Å—å

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- ‚úÖ –ö–∞–∂–¥—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è
- ‚úÖ API –æ—Å—Ç–∞–µ—Ç—Å—è —á–∏—Å—Ç—ã–º
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

---

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** –î–µ–∫–∞–±—Ä—å 2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ

