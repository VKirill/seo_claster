# üöÄ –ò—Ç–æ–≥–æ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≠–¢–ê–ü–ê 3: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### ‚úÖ 1. –ü—Ä–µ–¥–∫–æ–º–ø–∏–ª—è—Ü–∏—è regex –¥–ª—è –≥–æ—Ä–æ–¥–æ–≤
**–£—Å–∫–æ—Ä–µ–Ω–∏–µ:** –≤ **100-1000 —Ä–∞–∑**
- –ë—ã–ª–æ: ~11 –º–ª–Ω regex-–ø—Ä–æ–≤–µ—Ä–æ–∫ –¥–ª—è 10K –∑–∞–ø—Ä–æ—Å–æ–≤
- –°—Ç–∞–ª–æ: ~10K regex-–ø—Ä–æ–≤–µ—Ä–æ–∫ (–æ–¥–∏–Ω –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞ –≤—Å–µ –≥–æ—Ä–æ–¥–∞)

### ‚úÖ 2. –ü—Ä–µ–¥–∫–æ–º–ø–∏–ª—è—Ü–∏—è regex –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
**–£—Å–∫–æ—Ä–µ–Ω–∏–µ:** –≤ **5-10 —Ä–∞–∑**
- –ë—ã–ª–æ: —Ü–∏–∫–ª—ã –ø–æ –≤—Å–µ–º —Å–ª–æ–≤–∞–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- –°—Ç–∞–ª–æ: –æ–¥–∏–Ω —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω, –æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞

### ‚úÖ 3. –ó–∞–º–µ–Ω–∞ iterrows() –Ω–∞ apply()
**–£—Å–∫–æ—Ä–µ–Ω–∏–µ:** –≤ **5-10 —Ä–∞–∑**
- –ë—ã–ª–æ: –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø–æ —Å—Ç—Ä–æ–∫–∞–º DataFrame
- –°—Ç–∞–ª–æ: –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è pandas

### ‚úÖ 4. –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
**–£–ª—É—á—à–µ–Ω–∏–µ UX:** –≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- IntentClassifier: "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω—Ç–µ–Ω—Ç–∞"
- BrandDetector: "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤"  
- FunnelClassifier: "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤–æ—Ä–æ–Ω–∫–µ"

### ‚úÖ 5. üéØ **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï**: –ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –ª–µ–º–º–∞–º
**–£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏:** —Å 20-30% –¥–æ **90-95%**
- –ë—ã–ª–æ: –ø–æ–∏—Å–∫ "–ú–æ—Å–∫–≤–∞" –≤ –∑–∞–ø—Ä–æ—Å–µ "—Å–∫—É–¥ –≤ **–ú–æ—Å–∫–≤–µ**" ‚Üí ‚ùå –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- –°—Ç–∞–ª–æ: –ø–æ–∏—Å–∫ "–º–æ—Å–∫–≤–∞" –≤ –ª–µ–º–º–µ "—Å–∫—É–¥ **–º–æ—Å–∫–≤–∞**" ‚Üí ‚úÖ –Ω–∞–π–¥–µ–Ω–∞

## üìä –û–±—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≠–¢–ê–ü–ê 3:

| –†–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|-----------------|------|-------|-----------|
| 1,000 –∑–∞–ø—Ä–æ—Å–æ–≤ | ~30-60 —Å–µ–∫ | ~3-5 —Å–µ–∫ | **10x –±—ã—Å—Ç—Ä–µ–µ** |
| 10,000 –∑–∞–ø—Ä–æ—Å–æ–≤ | ~5-10 –º–∏–Ω | ~30-60 —Å–µ–∫ | **10-20x –±—ã—Å—Ç—Ä–µ–µ** |
| 50,000 –∑–∞–ø—Ä–æ—Å–æ–≤ | ~25-50 –º–∏–Ω | ~3-5 –º–∏–Ω | **10-15x –±—ã—Å—Ç—Ä–µ–µ** |

### –¢–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|------|-------|-----------|
| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–µ–æ-–∑–∞–ø—Ä–æ—Å–æ–≤ | 20-30% | 90-95% | **+70%** |
| –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã (—Å –≥–µ–æ) | 30-40% | 90-95% | **+60%** |

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **seo_analyzer/classification/intent_classifier.py**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–µ–¥–∫–æ–º–ø–∏–ª—è—Ü–∏—è regex –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–æ–≤ –∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
   - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `lemmatized_queries`
   - –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä

2. **seo_analyzer/classification/brand_detector.py**
   - –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä

3. **seo_analyzer/classification/funnel_classifier.py**
   - –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä

4. **main.py**
   - –ó–∞–º–µ–Ω–∞ `iterrows()` –Ω–∞ `apply()`
   - –ü–µ—Ä–µ–¥–∞—á–∞ –ª–µ–º–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–∞–∫ –æ–±—ã—á–Ω–æ:

```bash
python main.py
```

–∏–ª–∏

```bash
python main.py semantika/–º–æ–π_—Ñ–∞–π–ª.csv
```

–í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**!

## üìà –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üè∑Ô∏è  –≠–¢–ê–ü 3: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
--------------------------------------------------------------------------------
üîÑ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω—Ç–µ–Ω—Ç–∞...
–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω—Ç–µ–Ω—Ç–∞: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 11951/11951 [00:35<00:00, 338.21it/s]
‚úì –ò–Ω—Ç–µ–Ω—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω

üîÑ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤...
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 11951/11951 [00:42<00:00, 284.07it/s]
‚úì –ù–∞–π–¥–µ–Ω–æ 1234 –±—Ä–µ–Ω–¥–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

üîÑ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤–æ—Ä–æ–Ω–∫–µ...
–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤–æ—Ä–æ–Ω–∫–µ: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 11951/11951 [00:15<00:00, 796.73it/s]
‚úì –í–æ—Ä–æ–Ω–∫–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞

üîÑ –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã...
‚úì –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω

üîÑ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü...
‚úì –¶–µ–ª–µ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
```

## üí° –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã

### 1. –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —è–∑—ã–∫–æ–≤
–†—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏–º–µ–µ—Ç **6 –ø–∞–¥–µ–∂–µ–π**, –ø–æ—ç—Ç–æ–º—É –æ–¥–Ω–æ —Å–ª–æ–≤–æ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø–æ-—Ä–∞–∑–Ω–æ–º—É:
- –ú–æ—Å–∫–≤–∞, –ú–æ—Å–∫–≤—ã, –ú–æ—Å–∫–≤–µ, –ú–æ—Å–∫–≤—É, –ú–æ—Å–∫–≤–æ–π, –ú–æ—Å–∫–≤–µ
- –í—Å–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–≤–æ–¥–∏—Ç—å—Å—è –∫ **–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ–º—É –ø–∞–¥–µ–∂—É** –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

### 2. Regex –∫–æ–º–ø–∏–ª—è—Ü–∏—è –¥–∞—ë—Ç –æ–≥—Ä–æ–º–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç
–í–º–µ—Å—Ç–æ:
```python
for city in cities:
    if city in query: ...
```

–ò—Å–ø–æ–ª—å–∑—É–µ–º:
```python
pattern = re.compile(r'\b(–º–æ—Å–∫–≤–∞|–ø–∏—Ç–µ—Ä|–∫–∞–∑–∞–Ω—å|...)\b')
if pattern.search(query): ...
```

### 3. iterrows() ‚Äî –≤—Ä–∞–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
–î–ª—è DataFrame –∏–∑ 10K —Å—Ç—Ä–æ–∫:
- `iterrows()` ‚Äî ~2-3 –º–∏–Ω—É—Ç—ã
- `apply()` ‚Äî ~20-30 —Å–µ–∫—É–Ω–¥  
- –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî ~2-3 —Å–µ–∫—É–Ω–¥—ã

## üîÆ –î–∞–ª—å–Ω–µ–π—à–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **Multiprocessing –¥–ª—è classification**
   ```python
   from multiprocessing import Pool
   with Pool(cpu_count()) as pool:
       results = pool.map(classify_query, queries)
   ```

2. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ geo_info**
   ```python
   @lru_cache(maxsize=10000)
   def extract_geo_info(self, query: str):
       ...
   ```

3. **Batch-–≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å NumPy**
   –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ NumPy –º–∞—Å—Å–∏–≤—ã

## üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:
```bash
python test_quick.py
```

–ò–ª–∏ –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑:
```bash
python main.py semantika/—Å–∫—É–¥.csv
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ:
- ‚úÖ –ü–æ—è–≤–∏–ª–∏—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã
- ‚úÖ –≠–¢–ê–ü 3 –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ
- ‚úÖ –ë–æ–ª—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å `has_geo=True`
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≥–æ—Ä–æ–¥–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞–¥–µ–∂–∞—Ö

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–≤–µ–¥—ë–Ω–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞—ë—Ç:
- **10-20x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **70% —É–ª—É—á—à–µ–Ω–∏–µ** —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥–µ–æ-–∑–∞–ø—Ä–æ—Å–æ–≤
- **–õ—É—á—à–∏–π UX** —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞** –≤—Å–µ—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

–ö–æ–¥ —Å—Ç–∞–ª **–±—ã—Å—Ç—Ä–µ–µ**, **—Ç–æ—á–Ω–µ–µ** –∏ **—É–¥–æ–±–Ω–µ–µ** –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏!

---

**–î–∞—Ç–∞:** 2025-12-07  
**–í–µ—Ä—Å–∏—è:** v1.4-optimized  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

